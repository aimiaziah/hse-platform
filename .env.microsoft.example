# ============================================
# MICROSOFT AUTHENTICATION - RECOMMENDED SETUP
# ============================================
# This configuration is recommended for:
# - 1 admin + 1 supervisor + 1 inspector + 100+ employees
# - Teams where roles may change over time
# - Organizations that prefer UI-based role management
#
# Copy this file to .env and update with your values
# ============================================

# ============================================
# CORE CONFIGURATION
# ============================================

# Supabase (Required)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# JWT (Required)
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-64-character-random-string

# ============================================
# MICROSOFT AUTHENTICATION (Required)
# ============================================

# Enable Microsoft OAuth
ENABLE_MICROSOFT_AUTH=true
PREFER_MICROSOFT_AUTH=true

# Azure AD Application Credentials
# Get these from Azure Portal â†’ App registrations
NEXT_PUBLIC_SHAREPOINT_OAUTH_CLIENT_ID=abc123-def456-ghi789
NEXT_PUBLIC_SHAREPOINT_TENANT_ID=xyz987-uvw654-rst321

# ============================================
# SECURITY (Required)
# ============================================

# Restrict logins to your company domain
# Users outside this domain cannot log in
ALLOWED_EMAIL_DOMAINS=theta-edge.com

# ============================================
# ROLE ASSIGNMENT (Admin-Managed Approach)
# ============================================

# Only whitelist the initial admin
# All other roles will be assigned through the Admin UI
ADMIN_EMAIL_WHITELIST=john.admin@yourcompany.com

# Leave these empty - roles managed through UI:
# SUPERVISOR_EMAIL_WHITELIST=
# INSPECTOR_EMAIL_WHITELIST=

# ============================================
# HOW IT WORKS
# ============================================
#
# 1. Admin Login:
#    - john.admin@yourcompany.com logs in
#    - Gets "admin" role automatically (from whitelist above)
#    - Can access Admin Dashboard at /admin/users
#
# 2. Supervisor/Inspector Login:
#    - They log in with Microsoft account
#    - Get "employee" role initially
#    - Admin changes their role through UI to "supervisor" or "inspector"
#
# 3. Employee Login:
#    - All 100 employees log in with Microsoft account
#    - Get "employee" role automatically
#    - No admin action needed
#
# ============================================

# ============================================
# OPTIONAL CONFIGURATIONS
# ============================================

# Enable PIN authentication alongside Microsoft (optional)
ENABLE_PIN_AUTH=true

# Rate limiting for authentication
AUTH_RATE_LIMIT_MAX_REQUESTS=5
AUTH_RATE_LIMIT_WINDOW_MS=900000

# SharePoint Integration (optional)
NEXT_PUBLIC_SHAREPOINT_SITE_URL=https://yourcompany.sharepoint.com/sites/HSE
NEXT_PUBLIC_SHAREPOINT_LIBRARY_NAME=Documents
NEXT_PUBLIC_SHAREPOINT_BASE_FOLDER=Inspections

# DigitalOcean Spaces for image storage (optional)
DO_SPACES_NAME=your-space-name
DO_SPACES_REGION=sgp1
DO_SPACES_KEY=your-access-key
DO_SPACES_SECRET=your-secret-key

# AI Detection (optional)
AI_DEPLOYMENT_TYPE=gcp
GCP_CLOUD_RUN_ENDPOINT=https://your-cloud-run-url
AI_MIN_CONFIDENCE=0.3
AI_TIMEOUT_MS=30000

# ============================================
# QUICK START CHECKLIST
# ============================================
#
# [ ] 1. Create Azure AD app registration
# [ ] 2. Copy this file to .env
# [ ] 3. Update NEXT_PUBLIC_SHAREPOINT_OAUTH_CLIENT_ID
# [ ] 4. Update NEXT_PUBLIC_SHAREPOINT_TENANT_ID
# [ ] 5. Update ADMIN_EMAIL_WHITELIST with your admin's email
# [ ] 6. Update ALLOWED_EMAIL_DOMAINS with your company domain
# [ ] 7. Generate JWT_SECRET
# [ ] 8. Update Supabase credentials
# [ ] 9. Run migration: supabase/migrations/add_microsoft_auth.sql
# [ ] 10. Test login with admin account
# [ ] 11. Have supervisor/inspector log in
# [ ] 12. Assign roles through Admin UI at /admin/users
#
# ============================================

# ============================================
# SUPPORT & DOCUMENTATION
# ============================================
#
# Full Setup Guide: MICROSOFT_AUTH_SETUP.md
# Admin UI Code: src/pages/admin/users.tsx
# Role Mapping Logic: src/utils/microsoft-auth.ts
#
# ============================================
